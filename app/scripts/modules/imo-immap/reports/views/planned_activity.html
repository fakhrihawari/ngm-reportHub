<style>
	.collection.with-header .collection-item.avatar {
		padding-left: 51 !important;
	}

	.editable-wrap {
		width: 100%;
	}
</style>

<div style="padding-left: 20px;">
	<table class="bordered responsive-table" style="margin-bottom:10px;" ng-show="report.imo_report.planed_activity.length">
		<tr style="font-weight: 600">
			<td>Partner Category</td>
			<td>Partner</td>
			<td>Area of Activity</td>
			<!-- <td>Narative of Activity</td> -->
			<td>Products</td>
			<td>Number of Products</td>
			<td ng-if="report.definition.project_status !== 'complete'">{{'edit' | translate}}</td>
		</tr>
		<tr ng-repeat-start="planned in report.imo_report.planed_activity track by $index" ng-init="$plannedIndex=$index" style="border: 0px">
			<!-- Start here -->
			<!-- <td>
				<span e-form="imoform" 
					e-name="category_id" 
					editable-select="planned.category_id" 
					e-placeholder="{{'select'|translate}}"
					e-ng-options="a_t.id as a_t.name for a_t in report.partnerCategory"
					>
					{{report.displayPartnerCategory(report,$data,planned)}}
				</span>
			</td> -->
			<td>
				<span e-form="imoform" 
					e-name="category_id" 
					editable-select="planned.partner_category_id" 
					e-placeholder="{{'select'|translate}}"
					e-ng-options="a_t.id as a_t.name for a_t in report.partnerCategory"
					>
					{{report.displayPartnerCategory(report,$data,planned)}}
				</span>
			</td>
			<td>
				<span e-form="imoform" 
					e-name="partner_id" 
					editable-select="planned.partner_id" 
					e-placeholder="{{'select'|translate}}"
					e-ng-options="a_t.id as a_t.name for a_t in report.partner  | filter: {category_id:planned.category_id}"
					e-ng-disabled="!planned.partner_category_id"
					>
					{{report.displayPartner(report,$data,planned)}}
				</span>
			</td>
			<td>
				<span 
					e-form="imoform" 
					e-name="area_activity_id" 
					editable-select="planned.area_id" 
					e-placeholder="{{'select'|translate}}"
					e-ng-options="a_t.id as a_t.name for a_t in report.areaActivity"
					e-ng-disabled="!planned.partner_id">
					{{report.displayPlannedAreaActivity(report,$data,planned)}}
				</span>

			</td>
			<!-- <td>
				<span e-form="imoform" e-name="narative_activity_id" editable-select="planned.narative_activity_id" e-placeholder="{{'select'|translate}}"
				 e-ng-options="a_t.id as a_t.name for a_t in report.areaActivity" e-ng-disabled="!planned.area_activity_id">
					{{report.displayPlannedNarativeActivity(report,$data,planned)}}
				</span>
			</td> -->
			<td>
				<span 
					e-form="imoform" 
					e-name="product_id" 
					editable-select="planned.product_id" 
					e-placeholder="{{'select'|translate}}" 
					e-ng-options="a_t.id as a_t.name for a_t in report.products"
				  e-ng-disabled="!planned.area_id">
					{{report.displayPlannedProducts(report,$data,planned)}}
				</span>

			</td>
			<td>
				<span 
				e-form="imoform" 
				e-name="number_products" 
				editable-number="planned.number_products" 
				e-min="0" 
				e-ng-change="report.updateInputProduct($data,planned);">
					{{ planned.number_products }}
				</span>
			</td>
			<!-- End here -->
			<td style="white-space: nowrap" ng-show="report.report.report_status !== 'complete'">
				<!-- form -->
				<form editable-form name="imoform" onshow="report.keydownSaveForm()" ng-show="imoform.$visible"
				 class="form-buttons form-inline" shown="inserted == planned">
					<button type="submit" ng-if="imoform.$visible" ng-disabled="!report.plannedFormComplete(report.imo_report.planed_activity) || report.imo_report.report_submit"
					 class="btn btn-small waves-effect waves-light save" title="Save">
						<i class="material-icons">save</i>
					</button>
					<div type="button" ng-if="imoform.$visible" ng-disabled="imoform.$waiting" ng-click="imoform.$cancel(); report.cancelEdit( 'planed_activity', $plannedIndex );"
					 class="btn btn-small lighten-1 waves-effect waves-light" title="Cancel Edit" style="background-color: #be2126">
						<i class="material-icons">clear</i>
					</div>
				</form>
				<div class="buttons" ng-if="!imoform.$visible">
					<button class="btn btn-small waves-effect waves-light" ng-click="imoform.$show();"
					 title="Edit" ng-disabled="report.imo_report.report_submit">
						<i class="material-icons">create</i>
					</button>
					<button class="btn btn-small red lighten-2 waves-effect waves-light" ng-click="report.removePlanned( $plannedIndex );"
					 title="Remove" ng-disabled="!report.plannedFormComplete(report.imo_report.planed_activity) || report.imo_report.report_submit">
						<i class="material-icons">delete</i>
					</button>
				</div>
			</td>
		</tr>
		<tr>
			<td colspan="100" class=" card" style="padding: 20px">
				<h6 style="font-weight: 600;">Narative *</h6>
				<!-- <span editable-text="planned.narative" e-name="narative" e-form="imoform" e-ng-disabled="!planned.area_id">
					{{report.displayPlannedNarativeText($data,planned)}}
				</span> -->
				<textarea 
											id="ngm-planned-narative-{{$partnerIndex}}" 
											type="text" 
											class="validate materialize-textarea"
											name="narative"
											ng-model="planned.narative"
											ng-disabled="!imoform.$visible"
											e-form="imoform"
											>
										</textarea>
										<label for="ngm-planned-narative-{{$partnerIndex}}"></label>
			</td>
		</tr>
		<tr ng-repeat-end></tr>
	</table>

	<!-- default -->
	<button style="background-color: #be2126" class="btn"
	 ng-click="report.addPlanned()"
	 ng-disabled="addBeneficiaryDisable || report.imo_report.report_submit">
		<i class="material-icons left">add</i>Add Planned Activity

	</button>

</div>

<br/>
<script>
	// init
	setTimeout(function () { $('.input-field select').material_select(); }, 400);
</script>